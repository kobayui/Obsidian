# 参考文献
Evidence-based Prescriptive Analytics, CAUSAL Digital Twin and a Learning Estimation Algorithm  Dr.PG Madhavan

## 引言

基于证据的规范性分析、因果关系的数字孪生技术，以及通过学习理解测量数据揭示系统运行规律（“因果关系何在”）。在工业机械领域，我们难以通过随机对照试验（金标准）来验证因果关系！而数字孪生技术（DT）正是实现因果关系判定的利器。在我看来，当前缺乏能指导企业优化运营与生产的规范性分析工具——这需要将因果关系量化到超越简单相关性的层面。

开发和部署数字孪生技术的核心目标，在于深入理解“底层系统的参数特性”，从而构建基于证据的因果性规范分析模型、因果性数字孪生系统，以及通过持续学习来把握测量数据揭示的系统运行规律（即“何因何果”）。在工业设备领域，想要通过随机对照试验（金标准）来验证因果关系绝非易事！而数字孪生技术（DT）正是实现因果关系量化分析的利器。当前业界亟需能为运营决策提供精准指导的规范分析工具，助力企业优化生产流程——这需要将因果关系的量化分析突破简单相关性范畴，实现更深层次的因果关系量化。

显然，第一代“展示型”数字孪生技术通过仪表盘等界面，为物联网数据提供了直观展示窗口。在需要静态与结构分析的机械设计领域，“仿真型”数字孪生技术已展现出显著价值——例如采用CAD/CAM技术设计产品时，能实时呈现应力分布与热分布数据，这种可视化功能对优化机械设计具有重要参考价值。

然而，要提升系统运行效能，我们必须聚焦其动态特性。在“机器动力学”这一具体场景中，我们关注的是机器的动力学与运动学特性，而非静态或结构层面。本文提出了一种因果数字孪生（CDT）解决方案，能够精准捕捉互联系统的动态行为。

## 因果关系和IoT

因果数字孪生（CDT）为我们提供了一个模型，可用于进行“假设分析”，这是工业工厂（或其他互联资产系统）运营中“设定点”优化的基础。这种分析活动被称为规范性分析。简而言之，因果数字孪生使规范性分析成为可能，从而推动运营改进，最终从物联网（IoT）投资中创造商业价值。

当前所有的机器学习（ML）都建立在相关性分析的基础之上。但我们必须清醒认识到：“相关性并不等于因果关系”！当前这场“因果关系论战”的大部分功劳，要归功于图灵奖得主朱迪亚·珀尔（2011年图灵奖得主），他早在2000年代初就开始阐述因果演算学；彼得·斯皮特斯在因果关系领域的研究同样具有深远影响。因果关系研究主要集中在社会科学领域——流行病学、计量经济学、遗传学、市场调研等。这种历史背景使得工程师们难以获取这些庞大的知识库，并将其转化为物联网应用场景；而我在此的主要目标之一，正是要简化这一过程。

在本文后续部分，我将依据以下前两篇研究文献来构建因果数据理论（CDT）。由于相关研究数量庞大，若有所遗漏，谨向其他关键文献的作者致歉。第三篇参考文献则深入探讨了因果关系与根本原因分析。

## 因果关系基础

此处重点在于结构层面，而非各资产生成的传感器数据时间序列！需特别注意的关键点在于——时间依赖性将在后续讨论中详述。

如图1所示，我们考虑四个实体（资产）B1、B2、B3、B4。需要解答的问题包括：(1)所有关联是否都存在？（部分实体可能未被连接）；(2)若存在关联，其方向如何？(3)关联的强度或权重如何？前两个问题涉及“因果发现”（结构分析），第三个问题则涉及“因果估计”（当数据来自四个资产的传感器测量时间序列时，采用的统计/信号处理方法）。

![[Pasted image 20251027091214.png]]

省略

## 因果关系洞察

卡内基梅隆大学因果关系研究领域的资深专家彼得·斯皮特斯指出，分类与回归分析及因果推断存在本质区别。他在前文引用的第一篇文章中，通过概率推理对此进行了阐释。关键差异在于：从未被干预的总体样本中预测变量值（分类与回归）与从未干预总体样本中预测变量干预后值（因果关系）这两个问题存在根本差异。后者被称为“反事实分析”，正是这种分析方法揭示了两者的核心区别。

在有向无环图（DAG）中，当满足马尔可夫条件和忠实性条件，并对图应用d-分离时，因果因素表现为成对回归系数。

判断回归方向（X对Y还是Y对X）可通过以下步骤：首先估计各回归系数，生成残差数据，再进行独立性检验。若X确实导致Y，则该方向的残差将呈现独立性。反之，反向回归产生的残差虽无相关性（按定义），但不具备独立性。

当给定一个通过d-分离去除节点间条件独立链接的有向无环图（DAG），并根据残差判断链接方向后，我们就能得到如图2所示的因果图。在实际应用中，我们会设定一个核心结果变量——比如在肥皂品牌市场调研中，顾客满意度或可接受价格就是核心变量，其他节点则代表颜色、气味、尺寸等特征。调研团队会向多人发放问卷收集数据，这些数据构成了各节点的样本信息。图2展示的这个因果图，其因果方向是通过以B1为结果变量（图中用圆圈标出）来确定的。

![[Pasted image 20251027092056.png]]

从市场调研数据收集案例来看，必须明确时间因素并非因果分析中的变量——这种分析方式被称为“结构模型”或“瞬时因果关系”。以肥皂品牌营销研究为例：虽然测量数据来自不同消费者且采集时间各异，但时间戳对分析结果并无影响。这种结构因果关系属于“传统”因果关系范畴。然而在普遍情况下，延迟或“滞后”的测量数据及其因果依赖关系问题便随之浮现。

在物联网场景中，影响结果变量的因素除了普遍存在的结构性依赖外，还具有时间依赖性。由于物联网测量数据通常来自工厂车间内多个互联资产的时间序列，即时因果关系与滞后因果关系都至关重要。若资产在布局中的位置具有显著性，则结构模型会呈现空间分布特征。在最普遍的情况下，物联网数据用于构建有向无环图时，会形成时空多通道时间序列。

在物联网领域，我们主要研究的是人工构建的系统。后续我们将重点分析NASA轴承数据案例研究——一位深耕轴承领域多年的机械师，能精准指出振动的关键来源及其因果关系。为简化说明，我们采用领域专家在知识发现初期提供的有向无环图（DAG）及其关联方向。因此，下文将重点探讨因果关系估计这一核心课题。

## 因果参数的递归估计

![[Pasted image 20251027095120.png]]

![[Pasted image 20251027095140.png]]

## 原理证明

图6展示了所有4个轴承的DAG结构。通过IMRNNS算法，可同步对所有轴承的因果因素进行递归估计。

![[Pasted image 20251027095259.png]]

当轴承1发生故障时（连续24小时测量），我们没有使用2月12日至2月19日的完整时间序列，而是采用每个关键日期的10分钟数据块。轴承1的振动测量时间序列如图7所示。

在图7中需注意，数据并非连续呈现，而是将显示日期的10分钟数据块首尾相连。通过IMRNNS方法进行的因果因素评估是针对每个日期单独完成的。从图7可以明显看出：2月19日（轴承故障日）轴承1的振动异常剧烈，而2月12日则呈现正常振动模式。随着日期逼近2月16日、17日和18日，可以清晰观察到轴承1开始出现异常，其中2月16日的数据已略微显示出即将发生故障的迹象。

如果唯一的目标是预测故障，那么简单地对振动振幅进行阈值处理可能就足够了（但由于存在噪声等因素，该方法的鲁棒性较差）。

![[Pasted image 20251027095441.png]]

我们采用SVAR模型和IMRNNS算法，同步计算了四个轴承的瞬时和滞后耦合系数ke₀和−cM。为与机械动力学术语保持一致，我们将这些系数统称为‘耦合系数’。

在图8中，我们重点分析了轴承B1的失效行为，因为它是唯一发生故障的部件。数据显示，部分与B1的耦合强度在2月18日（甚至2月16日）就已开始增强。2月19日，当B1彻底失效时，系统的整体失稳现象似乎破坏了这种耦合特性（也可能是因为时间序列本身的特性导致估计结果变得异常脆弱）。

![[Pasted image 20251027095649.png]]

图9展示了截至2月18日所有轴承的耦合情况，显著耦合关系已用标签标注。

![[Pasted image 20251027100000.png]]

与仅使用振动振幅相比，当轴承1故障临近时，耦合系数会呈现系统性增长，这为多因素故障预测方案提供了可能。由于本研究每天仅处理10分钟的数据块（从当日144个数据块中随机选取的2月17日数据块存在疑问），因此无法判断预测能提前多久进行。若能处理所有连续数据，ke₀和−cM的轨迹将呈现平滑特性，从而为预测故障点提供可靠依据。

机械动力学专家对延迟耦合现象尤为关注，因为轴的弯曲可能是故障的根本原因，而延迟现象可能导致同一轴上的轴承1与其他轴承（尤其是B4）之间产生往复反馈动态。

需要指出的是，我们还研究了诸如成对轴承振动的方差比等简单因素，但未能获得任何有价值的信息。

![[Pasted image 20251027100359.png]]

综上所述，图9和图10清晰显示：2月18日的耦合数据能预测2月19日的故障；值得注意的是，部分耦合数据早在2月16日就已显现出异常。图10还呈现了极具参考价值的“展示型”数字孪生。当然，这些并非因果数字孪生的核心价值所在！

除了以新方式（如图10所示）可视化轴承的物联网数据外，因果模型的真正价值在于进行“假设”分析和反事实实验。我们将在下一节展示SVAR模型在这方面的能力。

## 假设分析

SVAR数字孪生技术通过测量数据估算参数，构建出因果图模型。当模型完成收敛后，即可在数据采集完成后进行离线实验——例如调整参数以评估对轴承1的影响。我们还开展了一项基础研究，验证SVAR因果数字孪生在假设分析方面的应用潜力。

假设当前时间为2月12日，我们已掌握当天的振动数据及前文所述模型。通过调整两个关键延迟耦合参数k13d和k14d（如图11右上角所示），使本次模拟的轴承1数据输出与故障前一天（2月18日）的轴承1数据保持一致。这种“假设分析”的核心价值在于：若延迟的k13和k14参数在2月13日达到14，...，设定阈值，即可推断轴承1很可能在次日发生故障。

## 反事实实验

因果模型的辨识能力体现在数据收集后进行反事实实验的能力。为验证这一点，我们评估了轴承3缺失对轴承1的影响。通过将耦合系数k13的即时值和滞后值设为零（见图12左下角），我们消除了轴承3的影响。图12展示了轴承1在2月18日（故障前一天）的数据结果。

[[BP+SVAR]]